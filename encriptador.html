<html>
<body>
<H1> Encriptador de texto con Javascript </H1> 
<H2> Ingrese el texto aqui </H2> 
<textarea id="cadena"></textarea>
<div>
Valor n√∫merico<input type="number" id="clave">
</div>
<div class="control-row">
            Que Hacer?:
            <select id="TipeCode">
                <option value="5"></option>
                <option value="0">codificar</option>
                <option value="1">DECODIFICAR</option>
            </select>
</div>
<button type="button" onclick="myFunction()">Ejecutar</button>
<div id="resultado"></div>
</body>
<head>
	<meta charset="utf-8">
	<script>
        function myFunction() {
            var TipeCode = document.getElementById("TipeCode").value;
            var cadena = document.getElementById("cadena").value;
            var clave = document.getElementById("clave").value;
            var doStaff = function (cadena, clave, TipeCode) {
                                cadena = cadena.toLowerCase()
                                var resultado = ""
                                var abc = 'abcdefghijklmnopqrstuvwxyz '
                                var longitud = abc.length;
                                for (var i = 0; i < cadena.length;  i++) {
                                    if (TipeCode == 0) {
                                    var indice = abc.indexOf(cadena[i]) ;
                                    var indice_char = parseInt(indice)  + parseInt(clave) ;
                                    var resto  = indice_char % longitud
                                    var nueva_letra = abc[resto]
                                    resultado += nueva_letra
                                    } else if (TipeCode == 1) {
                                    var indice = abc.indexOf(cadena[i]) ;
                                    var indice_char = parseInt(indice)  - parseInt(clave) ;
                                    var resto  = (indice_char % longitud )
                                    if (resto == 0) {
                                        resto  = 0
                                    }else if (resto <= 0) {
                                        resto  = (indice_char % longitud ) + longitud
                                    } else if ( resto >= 27 ){
                                        resto  = (indice_char % longitud ) - longitud
                                    }
                                    console.log("DATOS BRUTOS : ", resto, indice_char, indice )
                                    var nueva_letra = abc[resto]
                                    resultado += nueva_letra
                                }
                                } 
                                console.log(resultado)
                                return resultado
                                };
                var resultado = doStaff(cadena, clave, TipeCode)
                document.getElementById("resultado").innerHTML=doStaff(cadena, clave, TipeCode);
        }
	</script>
	<style>
		textarea {width:400px;}
	</style>
</head>
</html>